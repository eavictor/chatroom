{% extends "chat/base.html" %}
{% block content %}
    <div class="col-md-3"></div>



    <div class="col-md-6">
        <div id="message_box" style="min-height: 500px;"></div>
        <input type="text" class="form-control" placeholder="Text input" id="text_message">
        <input type="button" class="btn btn-success" id="send_text" value="Send">
    </div>



    <div class="col-md-3"></div>



    <script type="text/javascript">
    $(document).ready(
        function (){
            socket = new WebSocket("ws://" + window.location.host + "/chat/");

            {# open websocket #}
            socket.onopen = function(e){
                console.log(e);
            };

            {# receive text from server #}
            socket.onmessage = function(msg){
                console.log(msg);
                $("#message_box").append(msg);
            };

            {# send text message to server #}
            $("#send_text").click(function(){
                var message = $("#text_message");
                var message_text = message.val();
                if (message_text.length > 0) {
                    socket.send(message_text + "\r\n");
                    message.val("");
                }
            });
        }
    )
    </script>
{% endblock %}